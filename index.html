<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="/dist/netcode-client.js"></script>
</head>
<body>
    <script>
        window.addEventListener('load', () => {
            const { Client, BinaryEncoder, Handler, Int16Handler, TimeStampHandler, BooleanHandler } = netcode;
            const encoder = new BinaryEncoder([
                new Handler('open'),
                new Int16Handler('id'),
                new TimeStampHandler('ping'),
                new TimeStampHandler('pong'),
                new BooleanHandler('inverse'),
            ]);
            const client = new Client('ws://localhost:8002', encoder);
            let ping;

            client.addEventListener('pong', pong => {
                console.info('pong: %s ms', pong - ping);
            });

            client.addEventListener('id', id => {
                console.log('connected with id %s', id);
                ping = Date.now();
                client.send('ping', ping);
            });

            client.addEventListener('inverse', status => {
                client.send('inverse', !status);
                console.log('Inverse received: %s', status);
            });

            client.addEventListener('open', () => {
                console.info('Connection open.');
            });
        });
    </script>
</body>
</html>
